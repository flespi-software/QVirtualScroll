!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("core-js/modules/es6.function.name.js"),require("core-js/modules/es6.object.keys.js"),require("core-js/modules/es6.symbol.js"),require("core-js/modules/es6.object.get-own-property-descriptor.js"),require("core-js/modules/es7.object.get-own-property-descriptors.js"),require("@babel/runtime-corejs2/core-js/object/define-property"),require("@babel/runtime-corejs2/core-js/array/is-array"),require("@babel/runtime-corejs2/core-js/symbol"),require("@babel/runtime-corejs2/core-js/is-iterable"),require("@babel/runtime-corejs2/core-js/array/from"),require("@babel/runtime-corejs2/core-js/promise"),require("@babel/runtime-corejs2/regenerator"),require("core-js/modules/es6.array.filter.js"),require("core-js/modules/es6.regexp.match.js"),require("core-js/modules/es6.object.to-string.js"),require("core-js/modules/es6.regexp.to-string.js"),require("core-js/modules/es6.array.slice.js"),require("core-js/modules/es6.array.map.js"),require("core-js/modules/es7.array.includes.js"),require("core-js/modules/es6.array.iterator.js"),require("core-js/modules/web.dom.iterable.js"),require("lodash/get"),require("core-js/modules/es6.regexp.split.js"),require("lodash/set")):"function"==typeof define&&define.amd?define(["exports","core-js/modules/es6.function.name.js","core-js/modules/es6.object.keys.js","core-js/modules/es6.symbol.js","core-js/modules/es6.object.get-own-property-descriptor.js","core-js/modules/es7.object.get-own-property-descriptors.js","@babel/runtime-corejs2/core-js/object/define-property","@babel/runtime-corejs2/core-js/array/is-array","@babel/runtime-corejs2/core-js/symbol","@babel/runtime-corejs2/core-js/is-iterable","@babel/runtime-corejs2/core-js/array/from","@babel/runtime-corejs2/core-js/promise","@babel/runtime-corejs2/regenerator","core-js/modules/es6.array.filter.js","core-js/modules/es6.regexp.match.js","core-js/modules/es6.object.to-string.js","core-js/modules/es6.regexp.to-string.js","core-js/modules/es6.array.slice.js","core-js/modules/es6.array.map.js","core-js/modules/es7.array.includes.js","core-js/modules/es6.array.iterator.js","core-js/modules/web.dom.iterable.js","lodash/get","core-js/modules/es6.regexp.split.js","lodash/set"],t):t((e=e||self).devicesMessages={},0,0,0,0,0,e.defineProperty$1,e.isArray,e.symbol,e.isIterable,e.from,e.promise,e._regeneratorRuntime,0,0,0,0,0,0,0,0,0,e._get,0,e.set)}(this,function(e,t,r,s,n,o,a,c,i,u,l,p,M,f,m,d,g,h,y,b,v,j,S,x,w){"use strict";function _(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function O(e,t){return e(t={exports:{}},t.exports),t.exports}a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,i=i&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,p=p&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p,M=M&&Object.prototype.hasOwnProperty.call(M,"default")?M.default:M,S=S&&Object.prototype.hasOwnProperty.call(S,"default")?S.default:S,w=w&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w;var k=_(O(function(e){e.exports=function(e,t,r){return t in e?a(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.default=e.exports,e.exports.__esModule=!0})),D=O(function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,s=new Array(t);r<t;r++)s[r]=e[r];return s},e.exports.default=e.exports,e.exports.__esModule=!0});_(D);var P=O(function(e){e.exports=function(e){if(c(e))return D(e)},e.exports.default=e.exports,e.exports.__esModule=!0});_(P);var L=O(function(e){e.exports=function(e){if(void 0!==i&&u(Object(e)))return l(e)},e.exports.default=e.exports,e.exports.__esModule=!0});_(L);var q=O(function(e){e.exports=function(e,t){if(e){if("string"==typeof e)return D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?l(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D(e,t):void 0}},e.exports.default=e.exports,e.exports.__esModule=!0});_(q);var E=O(function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.default=e.exports,e.exports.__esModule=!0});_(E);var I=_(O(function(e){e.exports=function(e){return P(e)||L(e)||q(e)||E()},e.exports.default=e.exports,e.exports.__esModule=!0})),C=_(O(function(e){function i(e,t,r,s,n,o,a){try{var c=e[o](a),i=c.value}catch(e){return void r(e)}c.done?t(i):p.resolve(i).then(s,n)}e.exports=function(c){return function(){var e=this,a=arguments;return new p(function(t,r){var s=c.apply(e,a);function n(e){i(s,t,r,n,o,"next",e)}function o(e){i(s,t,r,n,o,"throw",e)}n(void 0)})}},e.exports.default=e.exports,e.exports.__esModule=!0}));function N(t,e){var r,s=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),s.push.apply(s,r)),s}function R(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?N(Object(r),!0).forEach(function(e){k(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function V(e,t,r){var s,n={};return n=t?(t=(s=t.split(".")).shift(),s="".concat(s.join("."),".").concat(r),t=e.getItem(t),S(t,s,n)):e.getItem(r)||n}function T(e,t,r,s,n){var o,a=V(e,t,r)||{},n={customColsSchema:R(R({},(o=n).schemas),{},{_default:void 0,_protocol:void 0,_unsaved:void 0}),defaultColsSchema:{activeSchema:o.activeSchema,schemas:{_default:o.schemas._default,_protocol:o.schemas._protocol,_unsaved:o.schemas._unsaved}}},o=n.customColsSchema,n=n.defaultColsSchema;a[s]=n,a["custom-cols-schemas"]=R({},o),t?(o=(n=t.split(".")).shift(),t="".concat(n.join("."),".").concat(r),n=e.getItem(o)||{},w(n,t,a),e.set(o,n)):e.set(r,a)}function A(t,e){var r,s=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),s.push.apply(s,r)),s}function B(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?A(Object(r),!0).forEach(function(e){k(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var H=["timestamp","server.timestamp","ident","position.latitude","position.longitude","position.altitude","position.speed"];function $(e){var d=e.Vue,f=e.LocalStorage,m=e.errorHandler;function g(e){var t={};return e.limit&&(t.count=e.limit),e.filter&&(t.filter="".concat(e.filter)),e.from&&(t.from=Math.floor(e.from/1e3)),e.to&&(t.to=Math.floor(e.to/1e3)),e.reverse&&(t.reverse=e.reverse),t}function h(e){e.errors&&e.errors.forEach(function(e){e=new Error(e.reason);m&&m(e)})}function o(){return(o=C(M.mark(function e(t,r){var s,n,o;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s={activeSchema:"_default",schemas:{_default:{name:"_default",cols:r.reduce(function(e,t){return(H.includes(t.name)||t.__dest&&t.display)&&e.push({name:t.name,width:t.width}),e},[])},_protocol:{name:"_protocol",cols:r.reduce(function(e,t){return t.custom||e.push({name:t.name,width:150}),e},[])}},enum:{}},!r.length){e.next=13;break}if((n=r.reduce(function(e,t){var r=H.includes(t.name);return e.isDefault=e.isDefault&&(!t.display&&!r||t.display&&(r||!!t.__dest)),e.isProtocol=e.isProtocol&&!t.custom,t.display&&e.schema.push({name:t.name,width:t.width}),e.enum[t.name]=B({},t),delete e.enum[t.name].display,delete e.enum[t.name].width,e},{schema:[],enum:{},isDefault:!0,isProtocol:!0})).isDefault&&n.isProtocol){e.next=12;break}return e.next=6,d.connector.gw.getChannelProtocolsDeviceTypes("all",t,{fields:"title"});case 6:o=e.sent,h(o=o.data),o=S(o,"result[0].title","Custom-".concat(t)),s.activeSchema=o,s.schemas[o]={name:o,cols:n.schema};case 12:s.enum=n.enum;case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function y(){var r=(new Date).toString().match(/([-+][0-9]+)\s/)[1];return H.reduce(function(e,t){return e[t]={name:t},t.match(/timestamp$/)&&(e[t].addition="".concat(r.slice(0,3),":").concat(r.slice(3)),e[t].type="",e[t].unit=""),e},{})}function b(){return(b=C(M.mark(function e(t,r){var s,n;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=M.keys(r);case 1:if((e.t1=e.t0()).done){e.next=15;break}if(s=e.t1.value,n=r[s],Array.isArray(n))return e.next=7,function(){return o.apply(this,arguments)}(t.active,n);e.next=12;break;case 7:n=e.sent,T(f,t.lsNamespace,t.name,s,n),r[s]=n,e.next=13;break;case 12:n.enum&&(delete n.enum,T(f,t.lsNamespace,t.name,s,n),r[s]=n);case 13:e.next=1;break;case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}},e)}))).apply(this,arguments)}function r(){return(r=C(M.mark(function e(t,r){var s,n,o,a,c,i,u,l,p;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.state,n=t.commit,u=t.rootState,o=r.etc,n("reqStart"),u.token&&s.active)return e.prev=4,d.set(s,"isLoading",!0),e.next=8,d.connector.gw.getDevices(s.active);e.next=47;break;case 8:if(c=e.sent,h(u=c.data),a=u.result&&u.result[0],n("setSettings",a),c=V(f,s.lsNamespace,s.name),function(){b.apply(this,arguments)}(s,c),c=c&&c[a.device_type_id],i=c||{activeSchema:"_default",schemas:{_default:{name:"_default",cols:H.map(function(e){return{name:e,width:150}})}},enum:y()},u=c&&c["custom-cols-schemas"]?c["custom-cols-schemas"]:{},i.schemas=B(B({},i.schemas),u),i.enum||(i.enum=y()),a.device_type_id)return e.next=23,d.connector.gw.getChannelProtocolsDeviceTypes("all",a.device_type_id,{fields:"protocol_id"});e.next=36;break;case 23:return l=e.sent,h(l=l.data),l=l.result&&l.result[0]&&l.result[0].protocol_id,e.next=29,d.connector.gw.getChannelProtocols(l,{fields:"message_parameters"});case 29:l=e.sent,h(l=l.data),l=l.result&&l.result[0]&&l.result[0].message_parameters,i.schemas._protocol={name:"_protocol",cols:[]},p=(new Date).toString().match(/([-+][0-9]+)\s/)[1],l.forEach(function(e){var t=e.name,r={name:t,type:e.type||"",unit:e.unit||"",description:e.info||""},e={name:t,width:150};if(t.match(/timestamp$/)&&(r.addition="".concat(p.slice(0,3),":").concat(p.slice(3)),r.type="",r.unit="",e.width=190,"timestamp"===t))return i.schemas._protocol.cols.unshift(e),void(i.enum.timestamp=r);i.schemas._protocol.cols.push(e),i.enum[t]=r});case 36:o&&(a.device_type_id&&i.schemas._protocol.cols.push({name:"etc",width:150,__dest:"etc"}),c||i.schemas._default.cols.push({name:"etc",width:150,__dest:"etc"})),i.enum.etc={name:"etc",__dest:"etc"},n("setCols",i),d.set(s,"isLoading",!1),e.next=47;break;case 42:e.prev=42,e.t0=e.catch(4),m&&m(e.t0),DEV&&console.log(e.t0),d.set(s,"isLoading",!1);case 47:case"end":return e.stop()}},e,null,[[4,42]])}))).apply(this,arguments)}function t(){return(t=C(M.mark(function e(r){var s,n,o,a;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=r.state,n=r.commit,r.rootState.token&&s.active)return e.prev=2,d.set(s,"isLoading",!0),o={reverse:!0,count:1,fields:"timestamp"},e.next=7,d.connector.gw.getDevicesMessages(s.active,{data:JSON.stringify(o)});e.next=26;break;case 7:if(a=e.sent,h(o=a.data),a=Date.now(),o.result.length&&(a=Math.round(1e3*o.result[0].timestamp)),t=(t=a)||Date.now(),a={from:t=new Date(t).setHours(0,0,0,0),to:t+86399999},n("setFrom",a.from),n("setTo",a.to),a.to<Date.now())return e.next=18,function(){return k.apply(this,arguments)}({state:s});e.next=18;break;case 18:d.set(s,"isLoading",!1),e.next=26;break;case 21:e.prev=21,e.t0=e.catch(2),m&&m(e.t0),DEV&&console.log(e.t0),d.set(s,"isLoading",!1);case 26:case"end":return e.stop()}var t},e,null,[[2,21]])}))).apply(this,arguments)}function v(e,t){return s.apply(this,arguments)}function s(){return(s=C(M.mark(function e(t,r){var s,n,o,a;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=t.state,n=t.commit,a=t.rootState,n("reqStart"),n=[],a.token&&s.active)return o=s.isLoading,e.prev=5,o||d.set(s,"isLoading",!0),e.next=9,d.connector.gw.getDevicesMessages(s.active,{data:JSON.stringify(r)});e.next=21;break;case 9:a=e.sent,h(a=a.data),o||d.set(s,"isLoading",!1),n=a.result||[],e.next=21;break;case 16:e.prev=16,e.t0=e.catch(5),m&&m(e.t0),DEV&&console.log(e.t0),o||d.set(s,"isLoading",!1);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}},e,null,[[5,16]])}))).apply(this,arguments)}function c(e){return n.apply(this,arguments)}function n(){return(n=C(M.mark(function e(t){var r,s,n,o,a,c,i,u,l,p,f,m;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state,s=t.commit,n=t.rootState,r.isLoading){e.next=35;break}return d.set(r,"isLoading",!0),o=Math.floor(Date.now()/1e3),a=g(r),c=0,e.next=8,v({state:r,commit:s,rootState:n},a);case 8:if(i=e.sent,c+=i.length,u=Math.floor(Date.now()/1e3),l=a.to>=u&&r.limit&&i.length<r.limit&&!j,p=function(){},l)return e.next=16,x({state:r,commit:s,rootState:n});e.next=28;break;case 16:return p=e.sent,f=Math.floor(Date.now()/1e3),(m=g(r)).from=o,m.to=f,e.next=23,v({state:r,commit:s,rootState:n},m);case 23:m=e.sent,c+=m.length,i.splice.apply(i,[i.length,0].concat(I(m))),e.next=31;break;case 28:if((a.to<u||r.limit&&i.length>=r.limit)&&j)return e.next=31,w({state:r,commit:s,rootState:n});e.next=31;break;case 31:s("limiting",{type:"init",count:c}),s("setHistoryMessages",i),(l||r.realtimeEnabled)&&(p(),s("limiting",{type:"rt_init"})),d.set(r,"isLoading",!1);case 35:case"end":return e.stop()}},e)}))).apply(this,arguments)}function a(){return(a=C(M.mark(function e(t){var r,s,n,o,a,c;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state,s=t.commit,n=t.rootState,r.isLoading){e.next=21;break}if(d.set(r,"isLoading",!0),o=Math.floor(S(r,"messages[0].timestamp",r.to)-1),(a=g(r)).to=o,a.reverse=!0,j&&r.messages.length>2*r.limit)return e.next=10,w({state:r,commit:s,rootState:n});e.next=11;break;case 10:s("limiting",{type:"rt_deinit"});case 11:return e.next=13,v({state:r,commit:s,rootState:n},a);case 13:if((c=e.sent).length){e.next=17;break}return d.set(r,"isLoading",!1),e.abrupt("return",0);case 17:return s("limiting",{type:"prev",count:c.length}),s("prependMessages",c),d.set(r,"isLoading",!1),e.abrupt("return",c.length);case 21:case"end":return e.stop()}},e)}))).apply(this,arguments)}function i(){return(i=C(M.mark(function e(t){var r,s,n,o,a,c,i,u,l,p,f;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state,s=t.commit,n=t.rootState,r.isLoading){e.next=34;break}if(r.realtimeEnabled)return e.abrupt("return");e.next=4;break;case 4:return d.set(r,"isLoading",!0),o=Date.now(),p=Math.floor(S(r,"messages[".concat(r.messages.length-1,"].timestamp"),r.from)+1),a=g(r),c=0,a.from=p,e.next=12,v({state:r,commit:s,rootState:n},a);case 12:if(i=e.sent,c+=i.length,u=a.to>Math.floor(Date.now()/1e3)&&r.limit&&i.length<r.limit&&!j,l=function(){},u)return e.next=19,x({state:r,commit:s,rootState:n});e.next=29;break;case 19:return l=e.sent,p=Date.now(),(f=g(r)).from=Math.floor(o/1e3),f.to=Math.floor(p/1e3),e.next=26,v({state:r,commit:s,rootState:n},f);case 26:f=e.sent,c+=f.length,i.splice.apply(i,[i.length,0].concat(I(f)));case 29:return s("limiting",{type:"next",count:c}),s("appendMessages",i),u&&(l(),s("limiting",{type:"rt_init"})),d.set(r,"isLoading",!1),e.abrupt("return",c);case 34:case"end":return e.stop()}},e)}))).apply(this,arguments)}function u(){return(u=C(M.mark(function e(t,r){var s,n,o,a;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.state,n=t.commit,o=t.rootState,a=s.limit,n("clearMessages"),n("setReverse",!0),n("setLimit",r),e.next=7,c({state:s,commit:n,rootState:o});case 7:n("setReverse",!1),n("setLimit",a);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var l=[],j=0;function x(e){return p.apply(this,arguments)}function p(){return(p=C(M.mark(function e(t){var r,s,n;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.state,s=t.commit,t.rootState,n=r.filter?"$filter/payload=".concat(encodeURIComponent(r.filter)):void 0,e.next=4,d.connector.subscribeMessagesDevices(r.active,function(e){l.push(JSON.parse(e))},{rh:2,prefix:n});case 4:return r.realtimeEnabled=!0,e.abrupt("return",function(){var e;e=s,j=setInterval(function(){l.length&&(e("setRTMessages",I(l)),l=[])},500)});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function w(e){return _.apply(this,arguments)}function _(){return(_=C(M.mark(function e(t){var r,s;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.state,j&&(clearInterval(j),l=[],j=0),s=r.filter?"$filter/payload=".concat(encodeURIComponent(r.filter)):void 0,e.next=5,d.connector.unsubscribeMessagesDevices(r.active,void 0,{prefix:s});case 5:r.realtimeEnabled=!1;case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function O(){return(O=C(M.mark(function e(t){var r,s,n,o,a;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.state,s=t.commit,t.rootState.token&&r.active)return e.prev=2,d.set(r,"isLoading",!0),o=r.offline,n=o.start,a=o.end,o=o.lastMessageIndex,a={from:n,to:a},e.next=8,d.connector.gw.getDevicesMessages(r.active,{data:JSON.stringify(a)});e.next=20;break;case 8:a=e.sent,h(a=a.data),s("setMissingMessages",{data:a.result,index:o}),d.set(r,"isLoading",!1),e.next=20;break;case 15:e.prev=15,e.t0=e.catch(2),m&&m(e.t0),DEV&&console.log(e.t0),d.set(r,"isLoading",!1);case 20:case"end":return e.stop()}},e,null,[[2,15]])}))).apply(this,arguments)}function k(){return(k=C(M.mark(function e(t){var r;return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.state).hasNewMessages=!1,e.next=4,d.connector.subscribeMessagesDevices(r.active,function(){r.hasNewMessages=!0,w({state:r})},{rh:2});case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}return{getMessages:v,get:c,getPrevPage:function(e){return a.apply(this,arguments)},getNextPage:function(e){return i.apply(this,arguments)},pollingGet:x,getCols:function(e,t){return r.apply(this,arguments)},getHistory:function(e,t){return u.apply(this,arguments)},initTime:function(e){return t.apply(this,arguments)},unsubscribePooling:w,getMissedMessages:function(e){return O.apply(this,arguments)}}}function J(e){var r=e.Vue,s=e.LocalStorage,u=e.newMessagesInterseptor,n=0;function l(r){r.length&&r.forEach(function(e,t){r[t]["x-flespi-message-key"]=n++})}function o(e){e.messages.splice(0,e.messages.length),u&&u([]),c(e)}function p(e,t){var r=t.type,s=t.count;if(!e.limit)return!1;var n,o=e.messages,a=e.pages;switch(r){case"init":e.pages=s?[s]:[];break;case"prev":if(!s)break;3===a.length?(n=a[2],e.pages=[s].concat(I(a.slice(0,-1))),o.splice(o.length-n,n)):e.pages=[s].concat(I(a));break;case"next":if(!s)break;var c=a.length;3===c?(u=a[0],e.pages=[].concat(I(a.slice(1,3)),[s]),o.splice(0,u)):c<3&&a.push(s);break;case"rt_init":a.push(0);break;case"rt_deinit":var i=a.pop();o.splice(o.length-i,i);break;case"rt":var u=a.length,c=a[u-1]||0;c+s>e.limit?3<u?(i=a[0],e.pages=[].concat(I(a.slice(1,-1)),[c+s,0]),o.splice(0,i)):e.pages=[].concat(I(a.slice(0,-1)),[c+s,0]):e.pages[u-1]=c+s}}function t(){return(t=C(M.mark(function e(t){return M.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o(t),t.filter="",t.from=0,t.to=0,t.limit=1e3,t.reverse=!1,e.next=8,r.connector.unsubscribeMessagesDevices(t.active);case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}function a(e,t){T(s,e.lsNamespace,e.name,e.settings.device_type_id,t),r.set(e,"cols",t)}function c(e){r.set(e,"selected",[])}return{setOffline:function(e){e.offline={start:Math.floor(Date.now()/1e3),lastMessageIndex:e.messages.length-1}},setReconnected:function(e){e.offline.end=Math.floor(Date.now()/1e3)},clearOfflineState:function(e){e.offline=!1},setMissingMessages:function(e,t){var r=t.data,t=t.index;(e=e.messages).splice.apply(e,[t+1,0].concat(I(r)))},setHistoryMessages:function(e,t){e.reverse&&t.reverse(),l(t),u&&u(t),e.messages=t},setRTMessages:function(e,t){if(t&&t.length){l(t);var r=e.messages;if(e.sortBy){var s=t[0],n=e.sortBy,o=e.messages.length-1,a=null,c=!0;if(0<o)for(var i=o;0!==i||c;i--)!(r[i][n]>s[n]&&0!==(a=i)||!(c=!1));u&&u(t),a?r.splice.apply(r,[a,0].concat(I(t))):r.splice.apply(r,[r.length,0].concat(I(t)))}else u&&u(t),r.splice.apply(r,[r.length,0].concat(I(t)));p(e,{type:"rt",count:t.length})}},prependMessages:function(e,t){t&&t.length&&(t.reverse(),e=e.messages,l(t),u&&u(t),e.splice.apply(e,[0,0].concat(I(t))))},appendMessages:function(e,t){t&&t.length&&(e=e.messages,l(t),u&&u(t),e.splice.apply(e,[e.length,0].concat(I(t))))},clearMessages:o,setLimit:function(e,t){r.set(e,"limit",t)},limiting:p,setFilter:function(e,t){e.filter!==t&&r.set(e,"filter",t)},setFrom:function(e,t){r.set(e,"from",t)},setTo:function(e,t){r.set(e,"to",t)},reqStart:function(){DEV&&console.log("Start Request Devices messages")},setReverse:function(e,t){r.set(e,"reverse",t)},clear:function(e){return t.apply(this,arguments)},setActive:function(e,t){r.set(e,"active",t)},setCols:a,updateCols:a,setSelected:function(e,t){r.set(e,"selected",t)},clearSelected:c,setSortBy:function(e,t){r.set(e,"sortBy",t)},clearSortBy:function(e){r.set(e,"sortBy",null)},setSettings:function(e,t){r.set(e,"settings",t)}}}e.default=function(e){var t=e.Vue,r=e.LocalStorage,s=e.name,n=e.errorHandler,o=e.newMessagesInterseptor,e=S(s,"lsNamespace",void 0);return{namespaced:!0,state:{name:s=S(s,"name",s),lsNamespace:e,isLoading:!1,active:0,messages:[],pages:[],filter:"",settings:{},realtimeEnabled:!1,from:0,to:0,limit:1e3,reverse:!1,cols:void 0,offline:!1,selected:[],sortBy:null,hasNewMessages:null},actions:$({Vue:t,LocalStorage:r,errorHandler:n}),mutations:J({Vue:t,LocalStorage:r,newMessagesInterseptor:o})}},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=devicesMessages.js.map
