{"version":3,"file":"intervals.js","sources":["../node_modules/@babel/runtime-corejs2/helpers/defineProperty.js","../node_modules/@babel/runtime-corejs2/helpers/asyncToGenerator.js","../src/store/modules/ls.js","../src/store/modules/intervals/actions.js","../src/store/modules/intervals/mutations.js","../src/store/modules/intervals/index.js"],"sourcesContent":["var _Object$defineProperty = require(\"@babel/runtime-corejs2/core-js/object/define-property\");\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    _Object$defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","var _Promise = require(\"@babel/runtime-corejs2/core-js/promise\");\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    _Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new _Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n\nmodule.exports = _asyncToGenerator;","import get from 'lodash/get'\nimport set from 'lodash/set'\n\nfunction splitSchemas (cols) {\n  const customColsSchema = {\n    ...cols.schemas,\n    _default: undefined,\n    _protocol: undefined,\n    _unsaved: undefined\n  }\n  const defaultColsSchema = {\n    activeSchema: cols.activeSchema,\n    schemas: {\n      _default: cols.schemas._default,\n      _protocol: cols.schemas._protocol,\n      _unsaved: cols.schemas._unsaved\n    },\n    enum: cols.enum\n  }\n  return { customColsSchema, defaultColsSchema }\n}\nfunction getColsLS (LocalStorage, lsNamespace, name) {\n  let colsFromStorage = {}\n  if (lsNamespace) {\n    const lsPath = lsNamespace.split('.'),\n      lsItemName = lsPath.shift(),\n      lsRouteToItem = `${lsPath.join('.')}.${name}`,\n      appStorage = LocalStorage.getItem(lsItemName)\n    colsFromStorage = get(appStorage, lsRouteToItem, colsFromStorage)\n  } else {\n    colsFromStorage = LocalStorage.getItem(name) || colsFromStorage\n  }\n  return colsFromStorage\n}\n\nfunction setColsLS (LocalStorage, lsNamespace, name, active, cols) {\n  const colsFromStorage = getColsLS(LocalStorage, lsNamespace, name) || {}\n  const { customColsSchema, defaultColsSchema } = splitSchemas(cols)\n  colsFromStorage[active] = defaultColsSchema\n  colsFromStorage['custom-cols-schemas'] = { ...customColsSchema }\n  if (lsNamespace) {\n    const lsPath = lsNamespace.split('.'),\n      lsItemName = lsPath.shift(),\n      lsRouteToItem = `${lsPath.join('.')}.${name}`,\n      appStorage = LocalStorage.getItem(lsItemName) || {}\n    set(appStorage, lsRouteToItem, colsFromStorage)\n    LocalStorage.set(lsItemName, appStorage)\n  } else {\n    LocalStorage.set(name, colsFromStorage)\n  }\n}\n\nexport {\n  getColsLS,\n  setColsLS\n}\n","import _get from 'lodash/get'\nimport { getColsLS, setColsLS } from '../ls'\nconst defaultCols = ['begin', 'end', 'duration', 'timestamp', 'id']\nexport default function ({ Vue, LocalStorage, errorHandler }) {\n  function getParams (state) {\n    const params = {}\n    if (state.limit) {\n      params.count = state.limit\n    }\n    if (state.filter && state.sysFilter) {\n      params.filter = `${state.sysFilter},${state.filter}`\n    } else if (state.sysFilter && !state.filter) {\n      params.filter = `${state.sysFilter}`\n    } else if (!state.sysFilter && state.filter) {\n      params.filter = `${state.filter}`\n    }\n    if (state.begin && !state.reverse) {\n      if (!state.reverse) {\n        params.begin = Math.floor(state.begin / 1000)\n      }\n    }\n    if (state.end) {\n      params.end = Math.floor(state.end / 1000)\n    }\n    if (state.reverse) {\n      params.reverse = state.reverse\n    }\n    return params\n  }\n\n  /* migration to new format storing cols 28.12.20 */\n  async function migrateCols (active, cols) {\n    const schema = {\n      activeSchema: '_default',\n      schemas: {\n        _default: {\n          name: '_default',\n          cols: cols.reduce((res, col) => {\n            if ((defaultCols.includes(col.name) || (!!col.__dest && col.display))) {\n              res.push({ name: col.name, width: col.width })\n            }\n            return res\n          }, [])\n        },\n        _protocol: {\n          name: '_protocol',\n          cols: cols.reduce((res, col) => {\n            if (!col.custom) {\n              res.push({ name: col.name, width: 150 })\n            }\n            return res\n          }, [])\n        }\n      },\n      enum: {}\n    }\n    if (cols.length) {\n      const processedSchemaByCols = cols.reduce((res, col) => {\n        const isColDefault = defaultCols.includes(col.name)\n        res.isDefault = res.isDefault && ((!col.display && !isColDefault) || (col.display && (isColDefault || !!col.__dest)))\n        res.isProtocol = res.isProtocol && !col.custom\n        if (col.display) {\n          res.schema.push({ name: col.name, width: col.width })\n        }\n        res.enum[col.name] = { ...col }\n        delete res.enum[col.name].display\n        delete res.enum[col.name].width\n        return res\n      }, {\n        schema: [],\n        enum: {},\n        isDefault: true,\n        isProtocol: true\n      })\n      if (!processedSchemaByCols.isDefault || !processedSchemaByCols.isProtocol) {\n        const calcResp = await Vue.connector.gw.getCalcs(active, { fields: 'name' })\n        const calcData = calcResp.data\n        errorsCheck(calcData)\n        let name = _get(calcData, 'result[0].name', `Calc-${active}`)\n        name = `${name}[${active}]`\n        schema.activeSchema = name\n        schema.schemas[name] = {\n          name,\n          cols: processedSchemaByCols.schema\n        }\n      }\n      schema.enum = processedSchemaByCols.enum\n    }\n    return schema\n  }\n\n  function getDefaultColsSchema () {\n    const locale = new Date().toString().match(/([-+][0-9]+)\\s/)[1]\n    return {\n      activeSchema: '_default',\n      schemas: {\n        _default: {\n          name: '_default',\n          cols: defaultCols.map(name => ({ name, width: 150 }))\n        },\n        _protocol: {\n          name: '_protocol',\n          cols: defaultCols.map(name => ({ name, width: 150 }))\n        }\n      },\n      enum: defaultCols.reduce((res, name) => {\n        res[name] = { name }\n        if (name.match(/timestamp$/) || name === 'begin' || name === 'end') {\n          res[name].addition = `${locale.slice(0, 3)}:${locale.slice(3)}`\n          res[name].type = ''\n          res[name].unit = ''\n        }\n        return res\n      }, {})\n    }\n  }\n\n  async function getCols ({ state, commit }, counters) {\n    const colsFromStorage = getColsLS(LocalStorage, state.lsNamespace, state.name)\n    if (colsFromStorage && colsFromStorage[state.active] && colsFromStorage[state.active].length) {\n      let colsSchema = colsFromStorage[state.active]\n      const customColsSchemas = (colsFromStorage && colsFromStorage['custom-cols-schemas'])\n        ? colsFromStorage['custom-cols-schemas'] : {}\n      colsSchema.schemas = { ...colsSchema.schemas, ...customColsSchemas }\n      if (Array.isArray(colsSchema)) {\n        colsSchema = await migrateCols(state.active, colsSchema)\n        colsSchema.schemas = { ...colsSchema.schemas, ...customColsSchemas }\n        setColsLS(LocalStorage, state.lsNamespace, state.name, state.active, colsSchema)\n      }\n\n      /* adding sys cols after migration. 12.11.20 */\n      if (_get(colsSchema.enum, 'action.__dest', undefined) === 'action') {\n        delete colsSchema.enum.action\n      }\n      /* adding locale to all timestamps 26.01.21 */\n      const locale = new Date().toString().match(/([-+][0-9]+)\\s/)[1]\n      Object.keys(colsSchema.enum).forEach(name => {\n        if (name.match(/timestamp$/) || name === 'begin' || name === 'end') {\n          const col = colsSchema.enum[name]\n          col.addition = `${locale.slice(0, 3)}:${locale.slice(3)}`\n          col.type = ''\n          col.unit = ''\n        }\n      })\n      /* adding locale to all timestamps end */\n      commit('updateCols', colsSchema)\n    } else {\n      const colsSchema = getDefaultColsSchema()\n      const locale = new Date().toString().match(/([-+][0-9]+)\\s/)[1]\n      counters.forEach(counter => {\n        const name = counter.name\n        const enumCol = {\n          name,\n          description: `${counter.name}[${counter.type}]`\n        }\n        const schemaCol = {\n          name,\n          width: 100\n        }\n        if (name.match(/timestamp$/) || name === 'begin' || name === 'end') {\n          enumCol.addition = `${locale.slice(0, 3)}:${locale.slice(3)}`\n          enumCol.type = ''\n          enumCol.unit = ''\n          schemaCol.width = 190\n        }\n        colsSchema.schemas._protocol.cols.push(schemaCol)\n        colsSchema.enum[name] = enumCol\n      })\n      colsSchema.schemas._protocol.cols.push({ name: 'etc', width: 150, __dest: 'etc' })\n      colsSchema.schemas._default.cols.push({ name: 'etc', width: 150, __dest: 'etc' })\n      colsSchema.enum.etc = { name: 'etc', __dest: 'etc' }\n      commit('setCols', colsSchema)\n    }\n  }\n\n  function errorsCheck (data) {\n    if (data.errors) {\n      data.errors.forEach((error) => {\n        const errObject = new Error(error.reason)\n        errorHandler && errorHandler(errObject)\n      })\n    }\n  }\n\n  async function initTime ({ state, commit, rootState }) {\n    if (rootState.token && state.active && state.activeDevice) {\n      try {\n        Vue.set(state, 'isLoading', true)\n        const params = {\n          reverse: true,\n          count: 1,\n          fields: 'end,begin'\n        }\n        const resp = await Vue.connector.gw.getCalcsDevicesIntervals(state.active, state.activeDevice, 'all', { data: JSON.stringify(params) })\n        const data = resp.data\n        errorsCheck(data)\n        let dateBegin = Date.now(),\n          dateEnd = Date.now()\n        if (data.result.length) {\n          dateBegin = Math.round(data.result[0].begin * 1000)\n          dateEnd = Math.round(data.result[0].end * 1000)\n        }\n        dateBegin = new Date(dateBegin)\n        dateBegin.setHours(0, 0, 0, 0)\n        dateEnd = new Date(dateEnd)\n        dateEnd.setHours(23, 59, 59, 999)\n        commit('setBegin', dateBegin.valueOf())\n        commit('setEnd', dateEnd.valueOf())\n        Vue.set(state, 'isLoading', false)\n      } catch (e) {\n        errorHandler && errorHandler(e)\n        if (DEV) { console.log(e) }\n        Vue.set(state, 'isLoading', false)\n      }\n    }\n  }\n\n  async function get ({ state, commit, rootState }) {\n    commit('reqStart')\n    if (rootState.token && state.active && state.activeDevice) {\n      try {\n        Vue.set(state, 'isLoading', true)\n        const resp = await Vue.connector.gw.getCalcsDevicesIntervals(state.active, state.activeDevice, 'all', { data: JSON.stringify(getParams(state)) })\n        const data = resp.data\n        errorsCheck(data)\n        commit('setMessages', data.result)\n        Vue.set(state, 'isLoading', false)\n      } catch (e) {\n        errorHandler && errorHandler(e)\n        if (DEV) { console.log(e) }\n        Vue.set(state, 'isLoading', false)\n      }\n    }\n  }\n\n  const messageProcessing = (state, packet) => {\n    const message = JSON.parse(packet.payload)\n    const topic = packet.topic\n    const event = topic.split('/').slice(-1)[0]\n    switch (event) {\n      case 'created': {\n        const begin = state.begin,\n          end = state.end,\n          endDate = new Date(end),\n          intervalBegin = message.begin * 1000,\n          intervalEnd = message.end * 1000,\n          nowDate = new Date(),\n          isCurrentEndInTodayRange = endDate.getDate() === nowDate.getDate() && endDate.getMonth() === nowDate.getMonth() && endDate.getFullYear() === nowDate.getFullYear()\n        if ((intervalBegin <= end && intervalEnd >= begin) || isCurrentEndInTodayRange) {\n          Vue.set(state.messages, message.id, message)\n        }\n        break\n      }\n      case 'updated': {\n        if (state.messages[message.id]) {\n          Vue.set(state.messages, message.id, message)\n        }\n        break\n      }\n      case 'finished': {\n        if (state.messages[message.id]) {\n          Vue.set(state.messages, message.id, message)\n        }\n        break\n      }\n      case 'deleted': {\n        if (state.messages[message.id]) {\n          Vue.delete(state.messages, message.id)\n        }\n        break\n      }\n    }\n  }\n\n  let messagesBuffer = [],\n    intervalId = 0\n  function initRenderLoop (state) {\n    return setInterval(() => {\n      if (messagesBuffer.length) {\n        messagesBuffer.forEach(message => messageProcessing(state, message))\n        messagesBuffer = []\n      }\n    }, 500)\n  }\n  async function pollingGet ({ state, commit }) {\n    intervalId = initRenderLoop(state)\n    await Vue.connector.subscribeIntervals(state.active, state.activeDevice, '+', (message, topic, packet) => {\n      messagesBuffer.push(packet)\n    }, { rh: 2 })\n  }\n\n  /* unsubscribe from current active topic */\n  async function unsubscribePooling ({ state }) {\n    if (intervalId) { clearInterval(intervalId) }\n    await Vue.connector.unsubscribeIntervals(state.active, state.activeDevice, '+')\n  }\n\n  return {\n    get,\n    pollingGet,\n    initTime,\n    unsubscribePooling,\n    getCols\n  }\n}\n","import { setColsLS } from '../ls'\nexport default function ({ Vue, LocalStorage, filterHandler, newMessagesInterseptor }) {\n  function setMessages (state, data) {\n    if (data && data.length) {\n      if (state.reverse) {\n        data.reverse()\n      }\n      let messages = state.messages\n      newMessagesInterseptor && newMessagesInterseptor(data)\n      messages = data.reduce((result, message) => {\n        result[message.id] = message\n        return result\n      }, {})\n      Vue.set(state, 'messages', messages)\n    } else {\n      Vue.set(state, 'messages', [])\n    }\n  }\n\n  function clearMessages (state) {\n    Vue.set(state, 'messages', [])\n    newMessagesInterseptor && newMessagesInterseptor([])\n    clearSelected(state)\n  }\n\n  function setLimit (state, count) {\n    Vue.set(state, 'limit', count)\n  }\n\n  function setFilter (state, value) {\n    if (state.filter !== value) {\n      Vue.set(state, 'filter', value)\n    }\n  }\n\n  function setBegin (state, begin) {\n    Vue.set(state, 'begin', begin)\n  }\n\n  function setEnd (state, end) {\n    Vue.set(state, 'end', end)\n  }\n\n  function reqStart () {\n    if (DEV) {\n      console.log('Start Request intervals messages')\n    }\n  }\n\n  function setActive (state, id) {\n    state.newMessagesCount = 0\n    Vue.set(state, 'active', id)\n  }\n\n  function setReverse (state, val) {\n    Vue.set(state, 'reverse', val)\n  }\n\n  async function clear (state) {\n    clearMessages(state)\n    state.filter = ''\n    state.begin = 0\n    state.end = 0\n    state.limit = 1000\n    state.reverse = false\n    await Vue.connector.unsubscribeIntervals(state.active)\n  }\n\n  function setCols (state, cols) {\n    setColsLS(LocalStorage, state.lsNamespace, state.name, state.active, cols)\n    Vue.set(state, 'cols', cols)\n  }\n\n  const updateCols = setCols\n\n  function setSelected (state, indexes) {\n    Vue.set(state, 'selected', indexes)\n  }\n\n  function clearSelected (state) {\n    Vue.set(state, 'selected', [])\n  }\n\n  function setSortBy (state, field) {\n    Vue.set(state, 'sortBy', field)\n  }\n\n  function clearSortBy (state) {\n    Vue.set(state, 'sortBy', null)\n  }\n\n  function setActiveDevice (state, id) {\n    Vue.set(state, 'activeDevice', id)\n  }\n\n  return {\n    setMessages,\n    clearMessages,\n    setLimit,\n    setFilter,\n    setBegin,\n    setEnd,\n    reqStart,\n    setReverse,\n    clear,\n    setActive,\n    setCols,\n    updateCols,\n    setSelected,\n    clearSelected,\n    setSortBy,\n    clearSortBy,\n    setActiveDevice\n  }\n}\n","import getActions from './actions'\nimport getMutations from './mutations'\nimport get from 'lodash/get'\n\nexport default function ({ Vue, LocalStorage, name, errorHandler, filterHandler, newMessagesInterseptor }) {\n  const lsNamespace = get(name, 'lsNamespace', undefined)\n  name = get(name, 'name', name)\n  const actions = getActions({ Vue, LocalStorage, errorHandler }),\n    mutations = getMutations({ Vue, LocalStorage, filterHandler, newMessagesInterseptor })\n\n  const state = {\n    name,\n    lsNamespace,\n    isLoading: false,\n    active: 0,\n    activeDevice: 0,\n    messages: {},\n    filter: '',\n    sysFilter: '',\n    begin: Date.now() - 86400000,\n    end: Date.now(),\n    limit: 1000,\n    reverse: false,\n    cols: undefined,\n    selected: [],\n    sortBy: null\n  }\n\n  return {\n    namespaced: true,\n    state,\n    actions,\n    mutations\n  }\n}\n"],"names":["obj","key","value","_Object$defineProperty","enumerable","configurable","writable","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","_Promise","then","fn","self","this","args","arguments","apply","err","undefined","getColsLS","LocalStorage","lsNamespace","name","colsFromStorage","lsPath","split","lsItemName","shift","lsRouteToItem","join","appStorage","getItem","get","setColsLS","active","cols","customColsSchema","schemas","_default","_protocol","_unsaved","defaultColsSchema","activeSchema","enum","set","defaultCols","Vue","errorHandler","migrateCols","schema","reduce","res","col","includes","__dest","display","push","width","custom","length","processedSchemaByCols","isColDefault","isDefault","isProtocol","connector","gw","getCalcs","fields","calcResp","errorsCheck","calcData","data","_get","getDefaultColsSchema","locale","Date","toString","match","map","addition","slice","type","unit","counters","state","commit","colsSchema","customColsSchemas","Array","isArray","action","Object","keys","forEach","counter","enumCol","description","schemaCol","etc","errors","errObject","Error","reason","rootState","token","activeDevice","params","reverse","count","getCalcsDevicesIntervals","JSON","stringify","resp","dateBegin","now","dateEnd","result","Math","round","begin","end","setHours","valueOf","DEV","console","log","limit","filter","sysFilter","floor","messageProcessing","packet","message","parse","payload","topic","endDate","intervalBegin","intervalEnd","nowDate","isCurrentEndInTodayRange","getDate","getMonth","getFullYear","messages","id","delete","messagesBuffer","intervalId","initRenderLoop","setInterval","subscribeIntervals","rh","clearInterval","unsubscribeIntervals","pollingGet","initTime","unsubscribePooling","getCols","newMessagesInterseptor","filterHandler","clearMessages","clearSelected","setCols","setMessages","setLimit","setFilter","setBegin","setEnd","reqStart","setReverse","val","clear","setActive","newMessagesCount","updateCols","setSelected","indexes","setSortBy","field","clearSortBy","setActiveDevice","actions","getActions","mutations","getMutations","namespaced","isLoading","selected","sortBy"],"mappings":"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"}